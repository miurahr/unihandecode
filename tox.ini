[tox]
envlist = check, py35, py36, py37, py38, docs, pypy3

[testenv]
deps = -rrequirements.txt
passenv =
    HOME
    PATH
    TRAVIS
    TRAVIS_JOB_ID
    TRAVIS_BRANCH
commands =
    python -m pytest -vv

[pytest]
basepython =
    py35: python3.5
    py36: python3.6
    py37: python3.7
    py38: python3.8
    pypy3: pypy3
python_files = test*.py
addopts = --cov-report=term-missing:skip-covered --cov-append --cov=unihandecode

[testenv:check]
basepython = python3.7
deps =
    docutils
    check-manifest
    flake8
    readme-renderer
    pygments
    isort
    twine
skip_install = true
ignore_errors=true
commands =
    check-manifest {toxinidir}
    flake8 unihandecode tests setup.py
    isort --verbose --check-only --diff --recursive unihandecode tests setup.py
    python setup.py sdist
    twine check dist/*

[testenv:docs]
basepython = python3.7
deps = sphinx
commands =
    sphinx-build {posargs:-E} -b html docs build/docs
    sphinx-build -b linkcheck docs build/docs


[gh-actions]
python =
    3.5: py35
    3.6: py36
    3.7: py37
    3.8: py38
    pypy3: pypy3
